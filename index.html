<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Christmas Magic Ball</title>
    <script src="https://cdn.jsdelivr.net/npm/aframe@1.4.0/dist/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.1.5/dist/mindar-image-aframe.prod.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            overflow-x: hidden;
            min-height: 100vh;
            touch-action: pan-y;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 15px;
        }

        .header {
            text-align: center;
            padding: 20px 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            position: relative;
        }

        .language-switcher {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 8px;
        }

        .lang-btn {
            padding: 6px 12px;
            border: 2px solid white;
            border-radius: 15px;
            background: transparent;
            color: white;
            cursor: pointer;
            font-weight: bold;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .lang-btn.active {
            background: white;
            color: #1a2a6c;
        }

        .title {
            font-size: 1.8em;
            margin-bottom: 8px;
            text-shadow: 0 0 20px #ff0080;
            animation: glow 2s ease-in-out infinite alternate;
            padding: 0 50px;
        }

        .subtitle {
            font-size: 1em;
            opacity: 0.9;
        }

        .content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .ar-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(10px);
            order: 1;
        }

        #ar-scene {
            width: 100%;
            height: 60vh;
            min-height: 400px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
            background: rgba(0, 0, 0, 0.3);
            position: relative;
        }

        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            order: 2;
        }

        .instructions h2 {
            color: #ffeb3b;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.3em;
        }

        .step {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
        }

        .step-number {
            background: #ff0080;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
            font-size: 14px;
        }

        .step p {
            font-size: 14px;
            line-height: 1.4;
            margin: 0;
        }

        .wishes {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            backdrop-filter: blur(10px);
            order: 3;
        }

        .wish-item {
            background: linear-gradient(45deg, rgba(255, 0, 128, 0.3), rgba(0, 255, 255, 0.3));
            padding: 15px;
            margin: 12px 0;
            border-radius: 12px;
            border-left: 4px solid #ff0080;
            animation: float 3s ease-in-out infinite;
        }

        .wish-item p {
            font-size: 14px;
            line-height: 1.4;
            margin: 0;
        }

        .wish-item:nth-child(even) {
            animation-delay: 1.5s;
            border-left-color: #00ffff;
        }

        .loading {
            text-align: center;
            padding: 40px 20px;
            font-size: 1.1em;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
        }

        .control-panel {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 20px;
            background: linear-gradient(45deg, #ff0080, #00ffff);
            color: white;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s ease;
            min-width: 80px;
        }

        .btn:active {
            transform: scale(0.95);
        }

        .movement-instructions {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 12px;
            padding: 12px;
            margin-top: 12px;
            text-align: center;
            font-size: 13px;
        }

        .magic-effects {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }

        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ff0080;
            border-radius: 50%;
            animation: particle-float 3s ease-in-out infinite;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px #ff0080; }
            to { text-shadow: 0 0 30px #00ffff, 0 0 40px #ff0080; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        @keyframes particle-float {
            0%, 100% { 
                transform: translateY(0) translateX(0) scale(1);
                opacity: 0.7;
            }
            25% { 
                transform: translateY(-20px) translateX(10px) scale(1.2);
                opacity: 1;
            }
            50% { 
                transform: translateY(-40px) translateX(-5px) scale(0.8);
                opacity: 0.5;
            }
            75% { 
                transform: translateY(-20px) translateX(-10px) scale(1.1);
                opacity: 0.8;
            }
        }

        .hidden {
            display: none !important;
        }

        /* Mobile optimizations */
        @media (max-width: 480px) {
            .title {
                font-size: 1.5em;
                padding: 0 40px;
            }
            
            .btn {
                padding: 8px 12px;
                font-size: 12px;
                min-width: 70px;
            }
            
            #ar-scene {
                height: 50vh;
                min-height: 350px;
            }
        }

        @media (min-width: 768px) {
            .content {
                flex-direction: row;
            }
            
            .ar-section {
                flex: 1;
                order: 1;
            }
            
            .instructions {
                flex: 1;
                order: 2;
            }
            
            .wishes {
                order: 3;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="language-switcher">
                <button class="lang-btn active" onclick="switchLanguage('en')">EN</button>
                <button class="lang-btn" onclick="switchLanguage('uk')">UK</button>
            </div>
            
            <div id="en-content">
                <h1 class="title">üéÑ Magic Ball ‚ú®</h1>
                <p class="subtitle">Place marker & explore the magic!</p>
            </div>
            
            <div id="uk-content" class="hidden">
                <h1 class="title">üéÑ –ú–∞–≥—ñ—á–Ω–∞ –ö—É–ª—è ‚ú®</h1>
                <p class="subtitle">–ü–æ–∫–ª–∞–¥–∏ –º–∞—Ä–∫–µ—Ä —Ç–∞ –¥–æ—Å–ª—ñ–¥–∂—É–π –º–∞–≥—ñ—é!</p>
            </div>
        </header>

        <div class="content">
            <div class="ar-section">
                <div id="ar-scene">
                    <div id="en-loading" class="loading">
                        <p>üîÑ Loading Magic...</p>
                        <p>Tap "Start AR" & allow camera</p>
                    </div>
                    
                    <div id="uk-loading" class="loading hidden">
                        <p>üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
                        <p>–ù–∞—Ç–∏—Å–Ω–∏ "–°—Ç–∞—Ä—Ç AR" —Ç–∞ –¥–æ–∑–≤–æ–ª—å –∫–∞–º–µ—Ä—É</p>
                    </div>
                </div>
                
                <div id="en-movement" class="movement-instructions">
                    <p>üì± <strong>Mobile:</strong> Move around marker</p>
                    <p>üí´ <strong>Tap the ball</strong> for wishes!</p>
                </div>
                
                <div id="uk-movement" class="movement-instructions hidden">
                    <p>üì± <strong>–ú–æ–±—ñ–ª—å–Ω–∏–π:</strong> –†—É—Ö–∞–π—Å—è –Ω–∞–≤–∫–æ–ª–æ –º–∞—Ä–∫–µ—Ä–∞</p>
                    <p>üí´ <strong>–¢–æ—Ä–∫–∞–π –∫—É–ª—ñ</strong> –¥–ª—è –ø–æ–±–∞–∂–∞–Ω—å!</p>
                </div>
                
                <div class="control-panel">
                    <div id="en-buttons">
                        <button class="btn" onclick="startAR()">‚ñ∂Ô∏è Start</button>
                        <button class="btn" onclick="stopAR()">‚èπÔ∏è Stop</button>
                        <button class="btn" onclick="toggleSound()">üîä Sound</button>
                    </div>
                    
                    <div id="uk-buttons" class="hidden">
                        <button class="btn" onclick="startAR()">‚ñ∂Ô∏è –°—Ç–∞—Ä—Ç</button>
                        <button class="btn" onclick="stopAR()">‚èπÔ∏è –°—Ç–æ–ø</button>
                        <button class="btn" onclick="toggleSound()">üîä –ó–≤—É–∫</button>
                    </div>
                </div>
            </div>

            <div class="instructions">
                <div id="en-instructions">
                    <h2>üéØ How to Play:</h2>
                    <div class="step">
                        <div class="step-number">1</div>
                        <p>Tap "Start" & allow camera access</p>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <p>Point camera at the marker</p>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <p>Magic ball will appear!</p>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <p>Tap the ball - get wishes! ‚ú®</p>
                    </div>
                </div>
                
                <div id="uk-instructions" class="hidden">
                    <h2>üéØ –Ø–∫ –≥—Ä–∞—Ç–∏:</h2>
                    <div class="step">
                        <div class="step-number">1</div>
                        <p>–ù–∞—Ç–∏—Å–Ω–∏ "–°—Ç–∞—Ä—Ç" —Ç–∞ –¥–æ–∑–≤–æ–ª—å –∫–∞–º–µ—Ä—É</p>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <p>–ù–∞–≤–µ–¥–∏ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä</p>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <p>–ó'—è–≤–∏—Ç—å—Å—è –º–∞–≥—ñ—á–Ω–∞ –∫—É–ª—è!</p>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <p>–¢–æ—Ä–∫–∞–π –∫—É–ª—ñ - –æ—Ç—Ä–∏–º—É–π –ø–æ–±–∞–∂–∞–Ω–Ω—è! ‚ú®</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="wishes">
            <div id="en-wishes">
                <h2 style="text-align: center; color: #ffeb3b; margin-bottom: 15px;">
                    üåü Christmas Wishes!
                </h2>
                <div class="wish-item">
                    <p>May your eyes shine with joy this Christmas!</p>
                </div>
                <div class="wish-item">
                    <p>Magical gifts under the Christmas tree!</p>
                </div>
                <div class="wish-item">
                    <p>Christmas star light your path to adventures!</p>
                </div>
            </div>
            
            <div id="uk-wishes" class="hidden">
                <h2 style="text-align: center; color: #ffeb3b; margin-bottom: 15px;">
                    üåü –†—ñ–∑–¥–≤—è–Ω—ñ –ü–æ–±–∞–∂–∞–Ω–Ω—è!
                </h2>
                <div class="wish-item">
                    <p>–ù–µ—Ö–∞–π –æ—á—ñ —Å—è—é—Ç—å –≤—ñ–¥ —Ä–∞–¥–æ—â—ñ–≤ —Ü—å–æ–≥–æ –†—ñ–∑–¥–≤–∞!</p>
                </div>
                <div class="wish-item">
                    <p>–ß–∞—Ä—ñ–≤–Ω—ñ –ø–æ–¥–∞—Ä—É–Ω–∫–∏ –ø—ñ–¥ —è–ª–∏–Ω–∫–æ—é!</p>
                </div>
                <div class="wish-item">
                    <p>–•–∞–π –∑—ñ—Ä–∫–∞ –æ—Å–≤—ñ—Ç–∏—Ç—å —à–ª—è—Ö –¥–æ –ø—Ä–∏–≥–æ–¥!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Language management
        let currentLanguage = 'en';
        
        function switchLanguage(lang) {
            currentLanguage = lang;
            
            // Update language buttons
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.lang-btn[onclick="switchLanguage('${lang}')"]`).classList.add('active');
            
            // Show/hide content
            document.querySelectorAll('[id$="-content"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${lang}-content`).classList.remove('hidden');
            
            document.querySelectorAll('[id$="-loading"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${lang}-loading`).classList.remove('hidden');
            
            document.querySelectorAll('[id$="-movement"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${lang}-movement`).classList.remove('hidden');
            
            document.querySelectorAll('[id$="-buttons"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${lang}-buttons`).classList.remove('hidden');
            
            document.querySelectorAll('[id$="-instructions"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${lang}-instructions`).classList.remove('hidden');
            
            document.querySelectorAll('[id$="-wishes"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${lang}-wishes`).classList.remove('hidden');
        }

        // Wishes in both languages
        const wishes = {
            en: [
                "May your eyes shine with joy this Christmas! ‚ú®",
                "Magical gifts under the Christmas tree! üéÅ",
                "Christmas star light your path to adventures! ‚≠ê",
                "Snowflakes bring you magic! ‚ùÑÔ∏è",
                "Home filled with laughter & warmth! üè†"
            ],
            uk: [
                "–ù–µ—Ö–∞–π –æ—á—ñ —Å—è—é—Ç—å –≤—ñ–¥ —Ä–∞–¥–æ—â—ñ–≤ —Ü—å–æ–≥–æ –†—ñ–∑–¥–≤–∞! ‚ú®",
                "–ß–∞—Ä—ñ–≤–Ω—ñ –ø–æ–¥–∞—Ä—É–Ω–∫–∏ –ø—ñ–¥ —è–ª–∏–Ω–∫–æ—é! üéÅ",
                "–•–∞–π –∑—ñ—Ä–∫–∞ –æ—Å–≤—ñ—Ç–∏—Ç—å —à–ª—è—Ö –¥–æ –ø—Ä–∏–≥–æ–¥! ‚≠ê",
                "–°–Ω—ñ–∂–∏–Ω–∫–∏ –ø—Ä–∏–Ω–æ—Å—è—Ç—å —Ç–æ–±—ñ –º–∞–≥—ñ—é! ‚ùÑÔ∏è",
                "–î—ñ–º –Ω–∞–ø–æ–≤–Ω–µ–Ω–∏–π —Å–º—ñ—Ö–æ–º —Ç–∞ —Ç–µ–ø–ª–æ–º! üè†"
            ]
        };

        // Audio manager
        const audio = new Audio('fon.mp3');
        audio.loop = true;
        let isSoundOn = false;
        let currentScene = null;

        function toggleSound() {
            isSoundOn = !isSoundOn;
            if (isSoundOn) {
                audio.play().catch(e => console.log("Audio error"));
            } else {
                audio.pause();
            }
        }

        // Create magic particles
        function createMagicParticles() {
            const container = document.getElementById('ar-scene');
            const effects = document.createElement('div');
            effects.className = 'magic-effects';
            
            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.background = i % 3 === 0 ? '#ff0080' : i % 3 === 1 ? '#00ffff' : '#ffff00';
                particle.style.animationDelay = Math.random() * 2 + 's';
                particle.style.animationDuration = (2 + Math.random() * 2) + 's';
                effects.appendChild(particle);
            }
            
            container.appendChild(effects);
        }

        // AR scene
        function startAR() {
            createMagicParticles();
            
            const scene = document.createElement('a-scene');
            currentScene = scene;
            
            // Simple MindAR configuration
            scene.setAttribute('mindar-image', `
                imageTargetSrc: assets/marker.mind;
                maxTrack: 1;
                filterMinCF: 0.001;
                filterBeta: 1000;
            `);
            scene.setAttribute('embedded', '');
            scene.setAttribute('renderer', 'colorManagement: true;');
            scene.setAttribute('loading-screen', 'enabled: false;');

            // Camera
            const camera = document.createElement('a-camera');
            camera.setAttribute('position', '0 0 0');
            camera.setAttribute('look-controls', 'enabled: true');
            camera.setAttribute('cursor', 'rayOrigin: mouse; fuse: false;');
            scene.appendChild(camera);

            // Target
            const target = document.createElement('a-entity');
            target.setAttribute('mindar-image-target', 'targetIndex: 0');

            // MAGIC BALL - centered on marker
            const sphere = document.createElement('a-sphere');
            sphere.setAttribute('radius', '0.3');
            sphere.setAttribute('color', '#ff0080');
            sphere.setAttribute('transparent', 'true');
            sphere.setAttribute('opacity', '0.9');
            sphere.setAttribute('animation', 'property: rotation; to: 0 360 0; loop: true; dur: 8000');
            sphere.setAttribute('class', 'clickable');

            // Inner glow
            const innerGlow = document.createElement('a-sphere');
            innerGlow.setAttribute('radius', '0.25');
            innerGlow.setAttribute('color', '#00ffff');
            innerGlow.setAttribute('transparent', 'true');
            innerGlow.setAttribute('opacity', '0.6');
            innerGlow.setAttribute('animation', 'property: rotation; to: 360 0 0; loop: true; dur: 6000');

            // Outer ring
            const ring = document.createElement('a-ring');
            ring.setAttribute('radius-inner', '0.35');
            ring.setAttribute('radius-outer', '0.4');
            ring.setAttribute('color', '#ffff00');
            ring.setAttribute('transparent', 'true');
            ring.setAttribute('opacity', '0.7');
            ring.setAttribute('animation', 'property: rotation; to: 0 0 360; loop: true; dur: 4000');

            // Add all elements to target
            target.appendChild(sphere);
            target.appendChild(innerGlow);
            target.appendChild(ring);

            // Wish text directly on the ball
            let currentWishIndex = 0;
            const wishText = document.createElement('a-text');
            wishText.setAttribute('value', currentLanguage === 'en' ? 'Tap me! ‚ú®' : '–¢–æ—Ä–∫–∞–π—Å—è! ‚ú®');
            wishText.setAttribute('color', '#FFFFFF');
            wishText.setAttribute('align', 'center');
            wishText.setAttribute('position', '0 0.6 0');
            wishText.setAttribute('width', '1.5');
            wishText.setAttribute('class', 'wish-text');
            target.appendChild(wishText);

            // Click handler
            function handleClick() {
                // Ball animation
                sphere.setAttribute('animation', `
                    property: scale;
                    to: 1.5 1.5 1.5;
                    dur: 300;
                    dir: alternate;
                `);

                // Sound
                if (isSoundOn) {
                    const clickSound = new Audio('fon.mp3');
                    clickSound.volume = 0.1;
                    clickSound.play().catch(() => {});
                }

                // Update wish text
                currentWishIndex = (currentWishIndex + 1) % wishes[currentLanguage].length;
                wishText.setAttribute('value', wishes[currentLanguage][currentWishIndex]);
                
                // Color change
                const colors = ['#ff0080', '#00ffff', '#ffff00', '#ff00ff', '#00ff00'];
                sphere.setAttribute('color', colors[currentWishIndex % colors.length]);
            }

            // Add event listeners
            sphere.addEventListener('click', handleClick);
            innerGlow.addEventListener('click', handleClick);
            ring.addEventListener('click', handleClick);

            scene.appendChild(target);

            // Replace scene
            const arContainer = document.getElementById('ar-scene');
            arContainer.innerHTML = '';
            arContainer.appendChild(scene);

            console.log('AR started!');
        }

        function stopAR() {
            const arContainer = document.getElementById('ar-scene');
            const loadingHTML = currentLanguage === 'en' 
                ? '<div class="loading"><p>üîÑ AR Stopped</p><p>Tap "Start" to continue</p></div>'
                : '<div class="loading"><p>üîÑ AR –ó—É–ø–∏–Ω–µ–Ω–æ</p><p>–ù–∞—Ç–∏—Å–Ω–∏ "–°—Ç–∞—Ä—Ç" —â–æ–± –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏</p></div>';
            
            arContainer.innerHTML = loadingHTML;
            createMagicParticles();
            
            if (isSoundOn) {
                audio.pause();
            }
        }

        // Initialize magic particles
        document.addEventListener('DOMContentLoaded', function() {
            createMagicParticles();
        });
    </script>
</body>
</html>
