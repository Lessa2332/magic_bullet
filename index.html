<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Магічна Куля</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        
        .instructions {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 1000;
            max-width: 300px;
            font-size: 14px;
        }
        
        .prophecy-text {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: #ffd700;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1.2em;
            text-align: center;
            z-index: 1000;
            display: none;
            max-width: 80%;
            border: 2px solid gold;
        }
        
        .marker-link {
            color: #4ecdc4;
            text-decoration: underline;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="instructions">
        <h3>AR Магічна Куля</h3>
        <p>1. Наведіть камеру на маркер</p>
        <p>2. Натисніть на кулю для пророцтва</p>
        <p>Маркер: <span class="marker-link" onclick="downloadMarker()">Завантажити</span></p>
    </div>
    
    <div class="prophecy-text" id="prophecyText"></div>

    <a-scene 
        vr-mode-ui="enabled: false"
        arjs="sourceType: webcam; debugUIEnabled: false;"
        embedded
        renderer="logarithmicDepthBuffer: true;"
        cursor="rayOrigin: mouse"
        raycaster="objects: .clickable">
        
        <a-marker type="pattern" url="assets/marker.patt">
            <!-- Основна куля -->
            <a-sphere 
                class="clickable"
                id="magicBall"
                radius="0.5"
                position="0 1 0"
                color="#1a1a2e"
                transparent="true"
                opacity="0.9"
                metalness="0.8"
                roughness="0.2">
                
                <!-- Внутрішня куля -->
                <a-sphere 
                    radius="0.45"
                    color="#0f3460"
                    transparent="true"
                    opacity="0.6"
                    metalness="0.9"
                    roughness="0.1">
                </a-sphere>
                
                <!-- Блискіт -->
                <a-circle 
                    radius="0.5"
                    position="0.2 0.2 0.3"
                    color="#ffffff"
                    transparent="true"
                    opacity="0.3"
                    rotation="0 0 45">
                </a-circle>
                
                <!-- Частинки -->
                <a-entity id="particles-container"></a-entity>
                
                <!-- Текст -->
                <a-text 
                    id="prophecy"
                    value="Натисни"
                    align="center"
                    position="0 0 0.6"
                    color="#ffd700"
                    scale="2 2 2">
                </a-text>
            </a-sphere>
            
            <!-- Підставка -->
            <a-cylinder 
                position="0 -0.6 0"
                radius="0.3"
                height="0.1"
                color="#8B4513"
                metalness="0.7"
                roughness="0.3">
            </a-cylinder>
            
            <!-- Кільце -->
            <a-ring 
                position="0 -0.55 0"
                radius-inner="0.35"
                radius-outer="0.5"
                color="#daa520"
                rotation="-90 0 0">
            </a-ring>
            
            <!-- Кристали -->
            <a-entity id="crystals-container"></a-entity>
        </a-marker>
        
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        const prophecies = [
            "Твоє майбутнє сяє яскраво!",
            "Несподівана зустріч змінить все!",
            "Вір у себе - ти можеш все!",
            "Найкращі моменти ще попереду!",
            "Ти знайдеш відповіді!",
            "Нове захоплення чекає на тебе!",
            "Подорож відкриє нові горизонти!",
            "Наполегливість буде винагороджена!",
            "Зустріч з другом принесе радість!",
            "Творчість розкриється повністю!"
        ];
        
        function createParticles() {
            const container = document.getElementById('particles-container');
            for (let i = 0; i < 10; i++) {
                const particle = document.createElement('a-sphere');
                particle.setAttribute('radius', '0.02');
                particle.setAttribute('color', getRandomColor());
                particle.setAttribute('position', getRandomPosition(0.6));
                particle.setAttribute('animation', {
                    property: 'position',
                    to: getRandomPosition(0.6),
                    dur: 2000 + Math.random() * 2000,
                    loop: true,
                    dir: 'alternate'
                });
                container.appendChild(particle);
            }
        }
        
        function createCrystals() {
            const container = document.getElementById('crystals-container');
            const positions = [
                {x: 0.8, y: -0.3, z: 0},
                {x: -0.8, y: -0.3, z: 0},
                {x: 0, y: -0.3, z: 0.8},
                {x: 0, y: -0.3, z: -0.8}
            ];
            
            positions.forEach(pos => {
                const crystal = document.createElement('a-cone');
                crystal.setAttribute('radius-bottom', '0.04');
                crystal.setAttribute('radius-top', '0.01');
                crystal.setAttribute('height', '0.15');
                crystal.setAttribute('color', getRandomCrystalColor());
                crystal.setAttribute('position', pos);
                crystal.setAttribute('animation', {
                    property: 'rotation',
                    to: '0 360 0',
                    dur: 3000 + Math.random() * 3000,
                    loop: true
                });
                container.appendChild(crystal);
            });
        }
        
        function getRandomColor() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#feca57'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        function getRandomCrystalColor() {
            const colors = ['#ffd700', '#c0c0c0', '#b9f2ff'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        function getRandomPosition(radius) {
            const theta = Math.random() * Math.PI * 2;
            const phi = Math.acos(2 * Math.random() - 1);
            const x = radius * Math.sin(phi) * Math.cos(theta);
            const y = radius * Math.sin(phi) * Math.sin(theta);
            const z = radius * Math.cos(phi);
            return `${x} ${y} ${z}`;
        }
        
        function getRandomProphecy() {
            return prophecies[Math.floor(Math.random() * prophecies.length)];
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            const magicBall = document.getElementById('magicBall');
            const prophecyElement = document.getElementById('prophecy');
            const prophecyText = document.getElementById('prophecyText');
            
            createParticles();
            createCrystals();
            
            magicBall.addEventListener('click', function() {
                magicBall.setAttribute('animation', {
                    property: 'scale',
                    from: '1 1 1',
                    to: '1.2 1.2 1.2',
                    dur: 300,
                    loop: 2,
                    dir: 'alternate'
                });
                
                magicBall.setAttribute('color', '#4a148c');
                
                const prophecy = getRandomProphecy();
                prophecyElement.setAttribute('value', prophecy);
                
                prophecyText.textContent = prophecy;
                prophecyText.style.display = 'block';
                
                setTimeout(() => {
                    prophecyText.style.display = 'none';
                    magicBall.setAttribute('color', '#1a1a2e');
                }, 5000);
            });
        });
        
        function downloadMarker() {
            const link = document.createElement('a');
            link.href = 'https://raw.githubusercontent.com/AR-js-org/AR.js/master/data/images/hiro.png';
            link.download = 'magic-ball-marker.png';
            link.click();
        }
    </script>
</body>
</html>
